{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{2957:function(e,t,a){var s=a(5),n=a(2958);\"string\"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,\"\"]]);var i={insert:\"head\",singleton:!1};s(n,i);e.exports=n.locals||{}},2958:function(e,t,a){(t=a(6)(!1)).push([e.i,\"/*\\n* Copyright (c) 2018-2020 Red Hat, Inc.\\n* This program and the accompanying materials are made\\n* available under the terms of the Eclipse Public License 2.0\\n* which is available at https://www.eclipse.org/legal/epl-2.0/\\n*\\n* SPDX-License-Identifier: EPL-2.0\\n*\\n* Contributors:\\n*   Red Hat, Inc. - initial API and implementation\\n*/\\n\\n._1GNfTt_EYVofu3Umh70bun {\\n  max-width: 350px;\\n  margin-right: 10px;\\n}\\n\\n._2K0ybUc2WSudr3ZOTQQ9UR {\\n  color: #f37943;\\n  font-size: 0.8em;\\n}\\n\",\"\"]),t.locals={storageTypeSelector:\"_1GNfTt_EYVofu3Umh70bun\",experimentalStorageType:\"_2K0ybUc2WSudr3ZOTQQ9UR\"},e.exports=t},2959:function(e,t,a){var s=a(5),n=a(2960);\"string\"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,\"\"]]);var i={insert:\"head\",singleton:!1};s(n,i);e.exports=n.locals||{}},2960:function(e,t,a){(t=a(6)(!1)).push([e.i,\"/*\\n* Copyright (c) 2018-2020 Red Hat, Inc.\\n* This program and the accompanying materials are made\\n* available under the terms of the Eclipse Public License 2.0\\n* which is available at https://www.eclipse.org/legal/epl-2.0/\\n*\\n* SPDX-License-Identifier: EPL-2.0\\n*\\n* Contributors:\\n*   Red Hat, Inc. - initial API and implementation\\n*/\\n\\n._12nf9ZmMKKLIGXIKSEW_QT {\\n  max-width: 450px;\\n}\\n\",\"\"]),t.locals={workspaceName:\"_12nf9ZmMKKLIGXIKSEW_QT\"},e.exports=t},2961:function(e,t,a){var s=a(5),n=a(2962);\"string\"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,\"\"]]);var i={insert:\"head\",singleton:!1};s(n,i);e.exports=n.locals||{}},2962:function(e,t,a){(t=a(6)(!1)).push([e.i,\"/*\\n* Copyright (c) 2018-2020 Red Hat, Inc.\\n* This program and the accompanying materials are made\\n* available under the terms of the Eclipse Public License 2.0\\n* which is available at https://www.eclipse.org/legal/epl-2.0/\\n*\\n* SPDX-License-Identifier: EPL-2.0\\n*\\n* Contributors:\\n*   Red Hat, Inc. - initial API and implementation\\n*/\\n\\n._2nqCX2Vx1nuEQCKj9affkc {\\n  min-width: 330px;\\n  max-width: 330px;\\n}\\n\\n._2nqCX2Vx1nuEQCKj9affkc ul {\\n  max-height: 445px;\\n  overflow-y: auto;\\n}\\n\\n._2nqCX2Vx1nuEQCKj9affkc button:not(:last-child) svg {\\n  position: relative;\\n  top: 1px;\\n}\\n\",\"\"]),t.locals={templateSelector:\"_2nqCX2Vx1nuEQCKj9affkc\"},e.exports=t},2963:function(e,t,a){var s=a(5),n=a(2964);\"string\"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,\"\"]]);var i={insert:\"head\",singleton:!1};s(n,i);e.exports=n.locals||{}},2964:function(e,t,a){(t=a(6)(!1)).push([e.i,\"/*\\n* Copyright (c) 2018-2020 Red Hat, Inc.\\n* This program and the accompanying materials are made\\n* available under the terms of the Eclipse Public License 2.0\\n* which is available at https://www.eclipse.org/legal/epl-2.0/\\n*\\n* SPDX-License-Identifier: EPL-2.0\\n*\\n* Contributors:\\n*   Red Hat, Inc. - initial API and implementation\\n*/\\n\\n._1K9FNy64l3jg9359ba7LkM {\\n  max-width: 350px;\\n}\\n\",\"\"]),t.locals={namespaceSelector:\"_1K9FNy64l3jg9359ba7LkM\"},e.exports=t},2965:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"CustomWorkspaceTab\",(function(){return $}));var s=a(1),n=a.n(s),i=a(59),r=a(2849),l=a(2882),o=a(136),d=a(2920),c=a(2853),p=a(2831),h=a(2876),m=a(2901),u=a(11),g=a(135),f=a(2897),v=a(255),y=a(256),b=a(2957),S=a.n(b);class E extends n.a.PureComponent{constructor(e){super(e),this.storageTypes=[],this.options=[];const t=this.props.availableStorageTypes;Array.isArray(t)&&(this.storageTypes=t,this.storageTypes.forEach(e=>this.options.push(y.e(e))));const a=this.props.preferredStorageType;a&&(this.preferredType=a),this.state={isOpen:!1,isModalOpen:!1,selected:\"\"}}componentDidUpdate(e){if(e.storageType!==this.props.storageType){const e=this.props.storageType?y.e(this.props.storageType):\"\";this.setState({selected:e})}}componentDidMount(){this.props.storageType?this.setState({selected:y.e(this.props.storageType)}):this.setState({selected:y.e(this.preferredType)})}handleToggle(e){this.setState({isOpen:e})}handleSelect(e){this.props.onChange&&this.props.onChange(y.b(e)),this.setState({selected:e,isOpen:!1})}handleModalToggle(){this.setState(({isModalOpen:e})=>({isModalOpen:!e}))}getModalContent(){const e=this.storageTypes.some(e=>\"async\"===e)?n.a.createElement(c.a,null,n.a.createElement(\"span\",{className:S.a.experimentalStorageType},\" Experimental feature \"),n.a.createElement(\"br\",null),n.a.createElement(\"b\",null,\"Asynchronous Storage \"),\"is combination of Ephemeral and Persistent storages. It allows for faster I / O and keeps your changes, it does backup the workspace on stop and restores it on start.\"):\"\",t=this.storageTypes.some(e=>\"persistent\"===e)?n.a.createElement(c.a,null,n.a.createElement(\"b\",null,\"Persistent Storage\"),\" is slow I/O but persistent.\"):\"\",a=this.storageTypes.some(e=>\"ephemeral\"===e)?n.a.createElement(c.a,null,n.a.createElement(\"b\",null,\"Ephemeral Storage\"),\" allows for faster I/O but may have limited storage and is not persistent.\"):\"\",s=this.props.brandingStore.data.docs.storageTypes;return n.a.createElement(p.a,null,t,a,e,n.a.createElement(c.a,null,n.a.createElement(\"a\",{rel:\"noreferrer\",target:\"_blank\",href:s},\"Open documentation page\")))}render(){const{isOpen:e,selected:t,isModalOpen:a}=this.state;return n.a.createElement(h.a,{label:\"Storage Type\",fieldId:\"storage-type\"},n.a.createElement(m.a,{className:S.a.storageTypeSelector,\"aria-label\":\"Storage Type Selector\",\"aria-labelledby\":\"storage-type-selector-id\",variant:u.e.single,direction:u.d.down,toggleId:\"storage-type-toggle-button\",onToggle:e=>this.handleToggle(e),onSelect:(e,t)=>this.handleSelect(t),selections:t,isOpen:e},this.options.map(e=>n.a.createElement(g.a,{key:e,value:e}))),n.a.createElement(o.a,{variant:\"link\",onClick:()=>this.handleModalToggle()},\"Learn more about storage types\"),n.a.createElement(f.a,{variant:f.b.small,isOpen:a,\"aria-label\":\"Storage types info\",showClose:!0,\"aria-describedby\":\"storage-types-info\",onClose:()=>this.handleModalToggle()},this.getModalContent()))}}var C=Object(i.c)(e=>({brandingStore:e.branding,availableStorageTypes:Object(v.b)(e),preferredStorageType:Object(v.e)(e)}))(E),w=a(53),T=a(2859),N=a(2879),I=a(2959),O=a.n(I);class k extends n.a.PureComponent{constructor(e){super(e),this.state={name:this.props.name,generateName:this.props.generateName,validated:w.ValidatedOptions.default,placeholder:\"Enter a workspace name\"}}handleChange(e){this.setState({name:e}),this.props.onChange(e),this.validate(e)}validate(e){0!==e.length||this.props.generateName?0!==e.length&&e.length<3?this.setState({errorMessage:\"The name has to be at least 3 characters long.\",validated:w.ValidatedOptions.error}):e.length>100?this.setState({errorMessage:\"The name is too long. The maximum length is 100 characters.\",validated:w.ValidatedOptions.error}):!1!==new RegExp(\"^(?:[a-zA-Z0-9][-_.a-zA-Z0-9]{1,98}[a-zA-Z0-9])?$\").test(e)?this.setState({errorMessage:void 0,validated:w.ValidatedOptions.default}):this.setState({errorMessage:\"The name can contain digits, latin letters, underscores and it should not contain special characters like space, dollar, etc. It should start and end only with digit or latin letter.\",validated:w.ValidatedOptions.error}):this.setState({errorMessage:\"A value is required.\",validated:w.ValidatedOptions.error})}componentDidUpdate(e){e.name!==this.props.name&&(this.validate(this.props.name),this.setState({name:this.props.name})),e.generateName!==this.props.generateName&&this.setState({generateName:this.props.generateName})}render(){const{name:e,generateName:t,errorMessage:a,validated:s}=this.state,i=!t;let r;r=i?\"Enter a workspace name\":`will be auto-generated with the prefix \"${this.props.generateName}\"`;return n.a.createElement(h.a,{label:\"Workspace Name\",isRequired:i,fieldId:\"workspace-name\",helperTextInvalid:a,helperTextInvalidIcon:n.a.createElement(N.a,null),validated:s},n.a.createElement(T.a,{className:O.a.workspaceName,value:e,isRequired:!0,type:\"text\",id:\"workspace-name\",\"aria-describedby\":\"workspace-name-helper\",name:\"workspace-name\",onChange:e=>this.handleChange(e),minLength:3,maxLength:100,placeholder:r,validated:s}))}}var x=a(2904),L=a(2907),R=a(2830),D=a(2871),M=a(2872),P=a(172),_=a(331);class j extends n.a.PureComponent{constructor(e){super(e),this.options=this.buildSelectOptions(this.props.metadata),this.state={isOpen:!1}}clearSelect(){this.setState({selected:void 0,isOpen:!1})}buildSelectOptions(e){return e.map(e=>n.a.createElement(g.a,{key:e.links.self,value:this.buildOption(e)}))}buildOption(e){return{metadata:e,toString:()=>e.displayName,compareTo:t=>!(\"string\"!=typeof t||!e.displayName)&&e.displayName.toLowerCase().includes(t.toLowerCase())}}handleToggle(e){this.setState({isOpen:e})}handleSelect(e){const t=e;this.setState({selected:t,isOpen:!1}),this.props.onSelect(t.metadata)}handleClearSelection(){this.setState({selected:void 0,isOpen:!1}),this.props.onClear&&this.props.onClear()}handleCustomFilter(e){const t=e.target.value.toString();return\"\"!==t?this.options.filter(e=>e.props.value.compareTo(t)):this.options}render(){const{isOpen:e,selected:t}=this.state,a=\"typeahead-select-defile-id\";return n.a.createElement(\"div\",null,n.a.createElement(\"span\",{id:a,hidden:!0},\"Select a devfile template\"),n.a.createElement(m.a,{\"aria-labelledby\":a,isOpen:e,onClear:()=>this.handleClearSelection(),onFilter:e=>this.handleCustomFilter(e),onSelect:(e,t)=>this.handleSelect(t),onToggle:e=>this.handleToggle(e),placeholderText:\"Select a devfile template\",selections:t,typeAheadAriaLabel:\"Select a devfile template\",variant:u.e.typeahead},this.options))}}class V extends n.a.PureComponent{constructor(e){super(e),this.state={validated:w.ValidatedOptions.default,location:\"\"}}clearInput(){this.setState({errorMessage:void 0,location:\"\",validated:w.ValidatedOptions.default})}invalidateInput(){this.setState({errorMessage:\"Failed to load the devfile\",validated:w.ValidatedOptions.error})}handleChange(e,t){const a=t.target.validity;!0===a.valid?this.setState({validated:w.ValidatedOptions.default,errorMessage:void 0}):this.setState({validated:w.ValidatedOptions.error,errorMessage:a.typeMismatch?\"The URL is not valid.\":void 0}),this.setState({location:e})}handleClick(){this.props.onChange(this.state.location)}render(){const{location:e,validated:t,errorMessage:a}=this.state,s=\"\"===e||t===w.ValidatedOptions.error||this.props.isLoading;return n.a.createElement(n.a.Fragment,null,n.a.createElement(h.a,{fieldId:\"devfile-url\",validated:t,helperTextInvalid:a,helperTextInvalidIcon:n.a.createElement(N.a,null)},n.a.createElement(D.a,{direction:{default:\"row\"},grow:{default:\"grow\"}},n.a.createElement(M.a,{grow:{default:\"grow\"}},n.a.createElement(T.a,{id:\"devfile-url\",type:\"url\",\"aria-label\":\"URL of devfile\",validated:t,onChange:(e,t)=>this.handleChange(e,t),value:e})),n.a.createElement(M.a,null,n.a.createElement(o.a,{id:\"fetch-devfile-button\",isDisabled:s,variant:o.b.secondary,onClick:()=>this.handleClick()},\"Load Devfile\")))))}}var A=a(200),K=a(2961),F=a.n(K);class U extends n.a.PureComponent{constructor(e){super(e),this.state={isLoading:!1,alerts:[],metadata:this.props.devfileRegistries.metadata},this.devfileSelectRef=n.a.createRef(),this.devfileLocationRef=n.a.createRef()}componentDidUpdate(){this.factoryResolver=this.props.factoryResolver}handleDevfileClear(){this.props.onClear&&this.props.onClear()}async handleDevfileSelect(e){var t;null===(t=this.devfileLocationRef.current)||void 0===t||t.clearInput();try{const t=await this.props.requestDevfile(e.links.self),a=Object(A.safeLoad)(t);this.props.onDevfile(a)}catch(e){this.showAlert({key:\"load-devfile-failed\",title:\"Failed to load devfile. \"+e,variant:x.b.danger})}}async handleLocationChange(e){var t,a;null===(t=this.devfileSelectRef.current)||void 0===t||t.clearSelect();try{this.setState({isLoading:!0}),await this.props.requestFactoryResolver(e);const{resolver:t}=this.factoryResolver;if(\"repo\"===t.source)throw new Error(\"devfile.yaml not found in the specified GitHub repository root.\");this.props.onDevfile(t.devfile),this.setState({isLoading:!1})}catch(e){this.setState({isLoading:!1}),null===(a=this.devfileLocationRef.current)||void 0===a||a.invalidateInput(),this.showAlert({key:\"load-factory-resolver-failed\",title:\"Failed to resolve or load the devfile. \"+e,variant:x.b.danger})}}showAlert(e){const t=[...this.state.alerts,e];this.setState({alerts:t})}removeAlert(e){this.setState({alerts:[...this.state.alerts.filter(t=>t.key!==e)]})}render(){const{alerts:e,metadata:t,isLoading:a}=this.state;return n.a.createElement(n.a.Fragment,null,n.a.createElement(L.a,{isToast:!0},e.map(({title:e,variant:t,key:a})=>n.a.createElement(x.a,{variant:t,title:e,key:a,actionClose:n.a.createElement(R.a,{onClose:()=>this.removeAlert(a)})}))),n.a.createElement(h.a,{label:\"Devfile\",isRequired:!0,fieldId:\"devfile-selector\"},n.a.createElement(p.a,null,n.a.createElement(c.a,{component:c.b.small},\"Select a devfile from a templates or enter devfile URL\")),n.a.createElement(D.a,{direction:{default:\"column\",lg:\"row\"}},n.a.createElement(D.a,{direction:{default:\"row\"}},n.a.createElement(M.a,{grow:{default:\"grow\"},className:F.a.templateSelector},n.a.createElement(j,{ref:this.devfileSelectRef,metadata:t,onSelect:e=>this.handleDevfileSelect(e),onClear:()=>this.handleDevfileClear()})),n.a.createElement(\"span\",null,\"or\")),n.a.createElement(M.a,{grow:{default:\"grow\"}},n.a.createElement(V,{ref:this.devfileLocationRef,isLoading:a,onChange:e=>this.handleLocationChange(e)})))))}}var q=Object(i.c)(e=>({devfileRegistries:e.devfileRegistries,factoryResolver:e.factoryResolver}),{...P.a,..._.a})(U),H=a(328),Q=a(2839);class X extends n.a.PureComponent{constructor(e){super(e);const t=this.props.namespaces.find(e=>\"true\"===e.attributes.default)||this.props.namespaces[0];this.state={isExpanded:!1,selected:this.getDisplayName(t)}}getDisplayName(e){return e.attributes.displayName||e.name}handleToggle(e){this.setState({isExpanded:e})}handleSelect(e,t){const a=this.props.namespaces.find(e=>e.attributes.displayName===t||e.name===t);this.setState({selected:this.getDisplayName(a),isExpanded:!1}),this.props.onSelect(a)}render(){const e=this.props.namespaces.map(e=>e.attributes.displayName||e.name);return n.a.createElement(m.a,{variant:u.e.single,\"aria-label\":\"Infrastructure Namespace Selector\",onToggle:e=>this.handleToggle(e),onSelect:(e,t)=>this.handleSelect(e,t),selections:this.state.selected,isOpen:this.state.isExpanded,toggleId:this.props.fieldId},e.map((e,t)=>n.a.createElement(g.a,{key:t,value:e})))}}var W=a(2963),Z=a.n(W);class z extends n.a.PureComponent{constructor(e){super(e),this.fieldId=\"infrastructure-namespace\",this.namespaces=this.props.infrastructureNamespace.namespaces}buildInfrastructureNamespaces(){const e=this.namespaces;if(0!==e.length){if(1===e.length){const e=this.namespaces[0].attributes.displayName||this.namespaces[0].name;return n.a.createElement(T.a,{\"aria-describedby\":\"infrastructure-namespace-helper\",id:this.fieldId,isDisabled:!0,name:\"infrastructure-namespace\",readOnly:!0,type:\"text\",value:e})}return n.a.createElement(X,{fieldId:this.fieldId,namespaces:this.namespaces,onSelect:e=>this.props.onChange(e)})}}render(){const e=this.buildInfrastructureNamespaces();return n.a.createElement(h.a,{label:\"Namespace\",fieldId:this.fieldId,labelIcon:n.a.createElement(H.a,{isContentLeftAligned:!0,content:n.a.createElement(\"div\",null,\"The infrastructure namespace where the workspace will be created.\")},n.a.createElement(Q.a,null))},n.a.createElement(\"div\",{className:Z.a.namespaceSelector},e))}}var G=Object(i.c)(e=>({infrastructureNamespace:e.infrastructureNamespace}))(z);class $ extends n.a.PureComponent{constructor(e){super(e);const t=this.buildInitialDevfile(),a=Object(y.a)(t.attributes),s=t.metadata.name?t.metadata.name:\"\",i=s?\"\":t.metadata.generateName;this.state={devfile:t,storageType:a,generateName:i,workspaceName:s},this.devfileEditorRef=n.a.createRef()}buildInitialDevfile(e){const t={apiVersion:\"1.0.0\",metadata:{generateName:e||\"wksp-\"}};return Object(y.f)(t,this.props.preferredStorageType)}handleInfrastructureNamespaceChange(e){this.setState({namespace:e})}handleWorkspaceNameChange(e,t){const a=t||this.state.devfile;if(a){if(e){a.metadata.name=e,delete a.metadata.generateName;const t=\"\";this.setState({workspaceName:e,generateName:t})}this.setState({devfile:a}),this.updateEditor(a)}}handleStorageChange(e,t){const a=t||this.state.devfile;if(!a)return;const s=Object(y.f)(a,e);this.setState({storageType:e,devfile:s}),this.updateEditor(s)}handleNewDevfile(e){var t,a;let s;s=e?void 0===(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.persistVolumes)&&void 0===(null===(a=null==e?void 0:e.attributes)||void 0===a?void 0:a.asyncPersist)&&this.props.preferredStorageType?Object(y.f)(e,this.props.preferredStorageType):e:this.buildInitialDevfile();const{storageType:n,workspaceName:i}=this.state;i&&this.handleWorkspaceNameChange(i,s),n&&this.handleStorageChange(n,s),i||n||(this.setState({devfile:s}),this.updateEditor(s))}handleDevfileChange(e,t){var a,s;if(!t)return;if(this.setState({devfile:e}),null==e?void 0:e.attributes){const t=Object(y.a)(e.attributes);t!==this.state.storageType&&this.setState({storageType:t})}const n=(null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name)||\"\";n!==this.state.workspaceName&&this.setState({workspaceName:n});const i=null===(s=null==e?void 0:e.metadata)||void 0===s?void 0:s.generateName;i!==this.state.generateName&&this.setState({generateName:i})}updateEditor(e){var t;null===(t=this.devfileEditorRef.current)||void 0===t||t.updateContent(e)}handleCreate(){var e;return this.props.onDevfile(this.state.devfile,null===(e=this.state.namespace)||void 0===e?void 0:e.name)}render(){const{devfile:e,storageType:t,generateName:a,workspaceName:s}=this.state;return n.a.createElement(n.a.Fragment,null,n.a.createElement(r.a,{variant:r.b.light},n.a.createElement(l.a,{isHorizontal:!0},n.a.createElement(G,{onChange:e=>this.handleInfrastructureNamespaceChange(e)}),n.a.createElement(k,{generateName:a,name:s,onChange:e=>this.handleWorkspaceNameChange(e)}),n.a.createElement(C,{storageType:t,onChange:e=>this.handleStorageChange(e)}))),n.a.createElement(r.a,{isFilled:!0,variant:r.b.light},n.a.createElement(l.a,null,n.a.createElement(q,{onDevfile:e=>this.handleNewDevfile(e),onClear:()=>this.handleNewDevfile()}))),n.a.createElement(r.a,{className:\"workspace-details-editor\",variant:r.b.light},n.a.createElement(d.a,{ref:this.devfileEditorRef,devfile:e,decorationPattern:\"location[ \\\\t]*(.*)[ \\\\t]*$\",onChange:(e,t)=>this.handleDevfileChange(e,t)})),n.a.createElement(r.a,{variant:r.b.light},n.a.createElement(o.a,{variant:\"primary\",onClick:()=>this.handleCreate()},\"Create & Open\")))}}const J=Object(i.c)(e=>({settings:Object(v.g)(e),preferredStorageType:Object(v.e)(e)}));t.default=J($)}}]);","extractedComments":[]}