{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{2923:function(e,t,a){var s=a(5),l=a(2924);\"string\"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,\"\"]]);var n={insert:\"head\",singleton:!1};s(l,n);e.exports=l.locals||{}},2924:function(e,t,a){(t=a(6)(!1)).push([e.i,\"/*\\n * Copyright (c) 2018-2020 Red Hat, Inc.\\n * This program and the accompanying materials are made\\n * available under the terms of the Eclipse Public License 2.0\\n * which is available at https://www.eclipse.org/legal/epl-2.0/\\n *\\n * SPDX-License-Identifier: EPL-2.0\\n *\\n * Contributors:\\n *   Red Hat, Inc. - initial API and implementation\\n */\\n\\n._1Spoyqzf8q3rg50svZr1VR {\\n  margin-top: 6px;\\n  margin-left: 8px;\\n}\\n\\n.fXAzc3sKh0KuVGxLMffbP {\\n  flex-grow: 1;\\n}\\n\",\"\"]),t.locals={toolbarCheckbox:\"_1Spoyqzf8q3rg50svZr1VR\",toolbarToggleGroup:\"fXAzc3sKh0KuVGxLMffbP\"},e.exports=t},2925:function(e,t,a){var s=a(5),l=a(2926);\"string\"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,\"\"]]);var n={insert:\"head\",singleton:!1};s(l,n);e.exports=l.locals||{}},2926:function(e,t,a){(t=a(6)(!1)).push([e.i,\"/*\\n * Copyright (c) 2018-2020 Red Hat, Inc.\\n * This program and the accompanying materials are made\\n * available under the terms of the Eclipse Public License 2.0\\n * which is available at https://www.eclipse.org/legal/epl-2.0/\\n *\\n * SPDX-License-Identifier: EPL-2.0\\n *\\n * Contributors:\\n *   Red Hat, Inc. - initial API and implementation\\n */\\n\\n._11pPkwlVgXPhdhfJp18uFQ {\\n  margin-left: 23px;\\n}\\n\\n.LRWN68BrOId97dUKstNBh {\\n  min-width: 10em !important;\\n}\\n\\n._2wNnN5MB_NUq9Eqw6SNnge {\\n  white-space: pre-wrap !important;\\n}\\n\\n._2OHCJDMKhc_VRg5B1mIgJD {\\n  text-align: right;\\n}\\n\",\"\"]),t.locals={nameColumnTitle:\"_11pPkwlVgXPhdhfJp18uFQ\",lastModifiedColumnTitle:\"LRWN68BrOId97dUKstNBh\",projectsCell:\"_2wNnN5MB_NUq9Eqw6SNnge\",openIdeCell:\"_2OHCJDMKhc_VRg5B1mIgJD\"},e.exports=t},2972:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"WorkspacesListContainer\",(function(){return le}));var s=a(1),l=a.n(s),n=a(59),r=a(255),i=a(113),o=a(332),c=(a(201),a(458)),d=a(273),p=a(94),h=a(2906),u=a(2902),m=a(2904),f=a(2849),w=a(2831),g=a(2853),b=a(122),k=a(2868),E=a(15),A=a(329),v=a(114),S=a(116),y=a(2917),D=a(196),C=a(2858),O=a(2905),N=a(2859),R=a(136),T=a(2861),_=a(2911),P=a(2912),L=a(2860),W=a(2862),x=a(2863),j=a(2918),I=a(2923);class B extends l.a.PureComponent{constructor(e){super(e),this.state={enabledDelete:this.props.enabledDelete,selectedAll:this.props.selectedAll,filterValue:\"\"}}handleKeyboardEvents(){const e=document.querySelector(\"#workspaces-filter-input\");e?e.addEventListener(\"keydown\",e=>{switch(e.code){case\"Enter\":this.handleFilterApply();break;case\"Escape\":this.handleFilterChange(\"\"),this.props.onFilter(this.props.workspaces)}}):console.warn(\"Cannot attach listener: search input is not found.\")}handleToggleSelectAll(e){this.setState({selectedAll:e}),this.props.onToggleSelectAll(e)}handleFilterChange(e){this.setState({filterValue:e})}filterWorkspaces(e){return this.props.workspaces.filter(t=>Object(j.a)(t.devfile.metadata.name||\"\",e))}handleFilterApply(){const e=this.filterWorkspaces(this.state.filterValue);this.props.onFilter(e)}async handleBulkDelete(){this.props.onBulkDelete()}handleAddWorkspace(){this.props.onAddWorkspace()}componentDidMount(){this.handleKeyboardEvents()}componentDidUpdate(e){this.props.selectedAll!==e.selectedAll&&this.props.selectedAll!==this.state.selectedAll&&this.setState({selectedAll:this.props.selectedAll}),this.props.enabledDelete!==e.enabledDelete&&this.props.enabledDelete!==this.state.enabledDelete&&this.setState({enabledDelete:this.props.enabledDelete})}render(){const{selectedAll:e,filterValue:t,enabledDelete:a}=this.state,s=l.a.createElement(D.a,{variant:\"bulk-select\",className:I.toolbarCheckbox},l.a.createElement(C.a,{isChecked:e,onChange:e=>this.handleToggleSelectAll(e),\"aria-label\":\"Toggle: select all workspaces\",id:\"toggle-select-all-workspaces\",name:\"toggle-select-all-workspaces\"})),n=l.a.createElement(D.a,{variant:\"search-filter\"},l.a.createElement(O.a,null,l.a.createElement(N.a,{name:\"workspaces-filter-input\",id:\"workspaces-filter-input\",type:\"search\",\"aria-label\":\"Filter workspaces input\",placeholder:\"Search\",value:t,onChange:e=>this.handleFilterChange(e)}),l.a.createElement(R.a,{variant:\"control\",\"aria-label\":\"Filter workspaces\",onClick:()=>this.handleFilterApply()},l.a.createElement(L.a,null)))),r=l.a.createElement(T.a,{className:I.toolbarToggleGroup,breakpoint:\"md\",toggleIcon:l.a.createElement(W.a,null)},l.a.createElement(D.a,null,l.a.createElement(R.a,{variant:\"primary\",\"aria-label\":\"Delete selected workspaces\",isDisabled:!1===a,onClick:()=>this.handleBulkDelete()},\"Delete\")),l.a.createElement(D.a,{alignment:{md:\"alignRight\",lg:\"alignRight\",xl:\"alignRight\",\"2xl\":\"alignRight\"}},l.a.createElement(R.a,{variant:\"link\",\"aria-label\":\"Add a new workspace\",icon:l.a.createElement(x.a,null),iconPosition:\"left\",onClick:()=>this.handleAddWorkspace()},\"Add Workspace\")));return l.a.createElement(_.a,{id:\"workspaces-list-table-toolbar\"},l.a.createElement(P.a,null,s,n,r))}}var F=a(23),M=a(2864),K=a(2865),G=a(2834),U=a(2866),V=a(2845);class q extends l.a.PureComponent{render(){return l.a.createElement(M.a,{isFullHeight:!0,variant:M.b.small},l.a.createElement(K.a,{icon:V.a}),l.a.createElement(G.a,{headingLevel:\"h4\",size:\"lg\"},\"No Workspaces\"),l.a.createElement(U.a,null,l.a.createElement(R.a,{\"aria-label\":\"Add workspace\",variant:\"link\",onClick:()=>this.props.onAddWorkspace()},\"Add Workspace\")))}}class $ extends l.a.PureComponent{render(){return l.a.createElement(M.a,{isFullHeight:!0,variant:M.b.small},l.a.createElement(K.a,{icon:L.a}),l.a.createElement(G.a,{headingLevel:\"h4\",size:\"lg\"},\"Nothing Found\"),l.a.createElement(U.a,null,\"No workspaces match the filter criteria. Clear filter to show results.\"))}}var H=a(363),J=a(2896),z=a(2899);function X(e,t,a,s,n,r){const i=[];return t.filter(e=>s.includes(e.id)).sort((e,t)=>{var a,s,l,n;if(1===r.index){return Q(e.devfile.metadata.name||\"\",t.devfile.metadata.name||\"\",r.direction)}if(2===r.index){return Q((null===(a=e.attributes)||void 0===a?void 0:a.updated)||(null===(s=e.attributes)||void 0===s?void 0:s.created)||0,(null===(l=t.attributes)||void 0===l?void 0:l.updated)||(null===(n=t.attributes)||void 0===n?void 0:n.created)||0,r.direction)}return 0}).forEach(t=>{const s=n.includes(t.id),r=a.includes(t.id),o=Object(v.a)(t),c=Object(v.g)(e,o),d=Object(v.d)(t),p=Object(v.g)(e,d);try{i.push(function(e,t,a,s,n){if(!e.devfile.metadata.name)throw new Error(\"Empty workspace name.\");if(!e.attributes)throw new Error(\"Empty workspace attributes\");if(!e.namespace)throw new Error(\"Empty namespace\");const r=l.a.createElement(H.a,{status:e.status}),i=l.a.createElement(\"span\",null,r,l.a.createElement(\"a\",{href:s},e.devfile.metadata.name)),{created:o,updated:c}=e.attributes,d=parseInt(c||o,10);let p=\"\";if(d){Date.now()-d<36e5?(h=d,p=Object(z.a)(h,{addSuffix:!0})):p=function(e){return Object(J.a)(e,\"MMM dd, h:mm aaaa\")}(d)}var h;const u=(e.devfile.projects||[]).map(e=>{var t;return(null===(t=e.source)||void 0===t?void 0:t.location)||e.name}).join(\", \\n\")||\"-\";let m;m=a?\"deleting...\":l.a.createElement(\"a\",{href:n},\"Open\");return{cells:[{title:i,key:\"workspace-name\"},{title:p,key:\"last-modified-time\"},{title:u,key:\"projects-list\"},{title:m,key:\"open-ide-visible-sm\"},{title:m,key:\"open-ide-hidden-sm\"}],props:{workspaceId:e.id},selected:t||a,disableCheckbox:a}}(t,s,r,c,p))}catch(e){console.warn(\"Skip workspace: \",e)}}),i}function Q(e,t,a){return e>t?a===p.a.asc?1:-1:e<t?a===p.a.asc?-1:1:0}var Z=a(2925),Y=function(e,t,a,s){var l,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,s);else for(var i=e.length-1;i>=0;i--)(l=e[i])&&(r=(n<3?l(r):n>3?l(t,a,r):l(t,a))||r);return n>3&&r&&Object.defineProperty(t,a,r),r},ee=function(e,t){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class te extends l.a.PureComponent{constructor(e){super(e),this.columns=[{title:l.a.createElement(\"span\",{className:Z.nameColumnTitle},\"Name\"),dataLabel:\"Name\",transforms:[c.a]},{title:\"Last Modified\",dataLabel:\"Last Modified\",transforms:[c.a,Object(d.b)(Z.lastModifiedColumnTitle)]},{title:\"Project(s)\",dataLabel:\"Project(s)\",cellTransforms:[Object(d.b)(Z.projectsCell)]},{title:\"\",dataLabel:\" \",columnTransforms:[Object(d.b)(d.a.visibleOnSm,d.a.hiddenOnMd)]},{title:\"\",dataLabel:\" \",cellTransforms:[Object(d.b)(Z.openIdeCell,d.a.hidden,d.a.hiddenOnSm,d.a.visibleOnMd)]}];const t=this.props.workspaces.map(e=>e.id);this.state={filtered:t,selected:[],isSelectedAll:!1,rows:[],sortBy:{index:1,direction:p.a.asc}}}showAlert(e,t=m.b.warning){this.appAlerts.showAlert({key:\"workspaces-list-\"+Object(y.a)(4),title:e,variant:t})}buildRows(){const{history:e,isDeleted:t,workspaces:a}=this.props,{filtered:s,selected:l,sortBy:n}=this.state;return X(e,a,t,s,l,n)}actionResolver(e){const t=e.props.workspaceId,a=this.props.workspaces.find(e=>t===e.id);return a?[{title:\"Open in Verbose Mode\",isDisabled:!1===this.isEnabledAction(E.c.START_DEBUG_AND_OPEN_LOGS,E.e[a.status]),onClick:(e,t,a)=>this.handleAction(E.c.START_DEBUG_AND_OPEN_LOGS,a)},{title:\"Start in Background\",isDisabled:!1===this.isEnabledAction(E.c.START_IN_BACKGROUND,E.e[a.status]),onClick:(e,t,a)=>this.handleAction(E.c.START_IN_BACKGROUND,a)},{title:\"Stop Workspace\",isDisabled:!1===this.isEnabledAction(E.c.STOP_WORKSPACE,E.e[a.status]),onClick:(e,t,a)=>this.handleAction(E.c.STOP_WORKSPACE,a)},{title:\"Delete Workspace\",onClick:(e,t,a)=>this.handleAction(E.c.DELETE_WORKSPACE,a)}]:(console.warn(\"Unable to build list of actions: Workspace not found.\"),[])}isEnabledAction(e,t){if(e===E.c.START_DEBUG_AND_OPEN_LOGS||e===E.c.START_IN_BACKGROUND)switch(t){case E.e.STARTING:case E.e.RUNNING:case E.e.STOPPING:return!1;default:return!0}if(e===E.c.STOP_WORKSPACE)switch(t){case E.e.STARTING:case E.e.RUNNING:return!0;default:return!1}return!0}async handleAction(e,t){const a=t.props.workspaceId;try{if(e===E.c.DELETE_WORKSPACE){const e=this.props.workspaces.find(e=>a===e.id),t=(null==e?void 0:e.devfile.metadata.name)||a;try{await this.props.showConfirmation([t])}catch(e){return}}const t=await this.props.onAction(e,a);if(!t)return;this.props.history.push(t)}catch(t){const s=this.props.workspaces.find(e=>a===e.id),l=(null==s?void 0:s.devfile.metadata.name)?` \"${null==s?void 0:s.devfile.metadata.name}\"`:\"\",n=`Unable to ${e.toLocaleLowerCase()}${l}. `+t.toString().replace(\"Error: \",\"\");this.showAlert(n),console.warn(n)}}async handleBulkDelete(){const{selected:e}=this.state,{workspaces:t}=this.props;try{const a=e.map(e=>{const a=t.find(t=>e===t.id);return(null==a?void 0:a.devfile.metadata.name)||e});await this.props.showConfirmation(a)}catch(e){return}const a=e.map(async e=>{try{return await this.props.onAction(E.c.DELETE_WORKSPACE,e),e}catch(t){const a=this.props.workspaces.find(t=>e===t.id),s=`Unable to delete workspace${(null==a?void 0:a.devfile.metadata.name)?` \"${null==a?void 0:a.devfile.metadata.name}\"`:\"\"}. `+t.toString().replace(\"Error: \",\"\");throw this.showAlert(s),console.warn(s),new Error(s)}});try{const e=await Promise.allSettled(a);let t=0,s=0;const{selected:l}=this.state;if(e.forEach(e=>{if(\"fulfilled\"===e.status){t+=1;const a=l.indexOf(e.value);-1!==a&&l.splice(a,1)}else s+=1}),this.setState({selected:l}),s)if(s===a.length){const e=\"No workspaces were deleted.\";this.showAlert(e,m.b.warning)}else{const e=1===t?`${t} of ${a.length} workspaces was deleted.`:`${t} of ${a.length} workspaces were deleted. `;this.showAlert(e,m.b.warning)}else{const e=1===a.length?\"The workspace was deleted successfully\":a.length+\" workspaces were deleted successfully.\";this.showAlert(e,m.b.success)}}catch(e){const t=`Bulk workspaces deletion failed due to ${e}.`;console.error(t),this.showAlert(t,m.b.danger)}}handleFilter(e){const t=e.map(e=>e.id).filter(e=>this.state.selected.includes(e)),a=0!==t.length&&t.length===e.length;this.setState({filtered:e.map(e=>e.id),selected:t,isSelectedAll:a})}handleSelectAll(e){const t=!1===e?[]:[...this.state.filtered];this.setState({selected:t,isSelectedAll:e})}handleSelect(e,t,a){const{workspaces:s}=this.props;if(-1===t){const t=e,a=!1===t?[]:s.map(e=>e.id);return void this.setState({selected:a,isSelectedAll:t})}const l=a.props.workspaceId,n=[...this.state.selected],r=n.indexOf(l);-1===r?e&&n.push(l):e||n.splice(r,1);const i=0!==n.length&&n.length===s.length;this.setState({selected:n,isSelectedAll:i})}areActionsDisabled(e){const t=e.props.workspaceId;return this.props.isDeleted.includes(t)}handleAddWorkspace(){const e=Object(v.c)(\"custom-workspace\");this.props.history.push(e)}handleSort(e,t,a){this.setState({sortBy:{index:t,direction:a}})}componentDidUpdate(e){if(e.workspaces.length!==this.props.workspaces.length){const e=[],t=[];this.props.workspaces.forEach(a=>{-1!==this.state.selected.indexOf(a.id)&&e.push(a.id),-1!==this.state.filtered.indexOf(a.id)&&t.push(a.id)});const a=0!==e.length&&e.length===this.props.workspaces.length;this.setState({filtered:t,isSelectedAll:a,selected:e})}if(e.isDeleted.length!==this.props.isDeleted.length){const e=this.state.selected.filter(e=>!1===this.props.isDeleted.includes(e));this.setState({selected:e})}}render(){const{workspaces:e}=this.props,{workspace:t}=this.props.branding.docs,{selected:a,isSelectedAll:s,sortBy:n}=this.state,r=this.buildRows(),i=l.a.createElement(B,{workspaces:e,selectedAll:s,enabledDelete:0!==a.length,onAddWorkspace:()=>this.handleAddWorkspace(),onBulkDelete:()=>this.handleBulkDelete(),onFilter:e=>this.handleFilter(e),onToggleSelectAll:e=>this.handleSelectAll(e)});let o=l.a.createElement(l.a.Fragment,null);return 0===e.length?o=l.a.createElement(q,{onAddWorkspace:()=>this.handleAddWorkspace()}):0===r.length&&(o=l.a.createElement($,null)),l.a.createElement(l.a.Fragment,null,l.a.createElement(A.a,{pageName:\"Workspaces\"}),l.a.createElement(f.a,{variant:f.b.light},l.a.createElement(w.a,null,l.a.createElement(g.a,{component:\"h1\"},\"Workspaces\"),l.a.createElement(g.a,{component:\"p\"},\"A workspace is where your projects live and run. Create workspaces from stacks that define projects, runtimes, and commands. \",l.a.createElement(\"a\",{href:t,target:\"_blank\",rel:\"noopener noreferrer\"},\"Learn more \",l.a.createElement(k.a,null))))),l.a.createElement(f.a,{padding:{default:\"noPadding\"},variant:f.b.light,isFilled:!1},l.a.createElement(b.a,{component:\"div\",className:\"pf-u-mt-xl\"}),l.a.createElement(p.b,{actionResolver:e=>this.actionResolver(e),areActionsDisabled:e=>this.areActionsDisabled(e),\"aria-label\":\"Workspaces List Table\",canSelectAll:!1,cells:this.columns,onSelect:(e,t,a,s)=>this.handleSelect(t,a,s),rows:r,variant:p.d.compact,header:i,sortBy:n,onSort:(e,t,a)=>this.handleSort(e,t,a)},l.a.createElement(h.a,null),l.a.createElement(u.a,null))),o)}}Y([Object(F.b)(S.a),ee(\"design:type\",S.a)],te.prototype,\"appAlerts\",void 0);var ae=a(2919),se=a(2913);class le extends l.a.PureComponent{componentDidMount(){const{isLoading:e,requestWorkspaces:t}=this.props;e||t()}render(){const{branding:e,history:t,allWorkspaces:a,isLoading:s}=this.props;return s?o.a:l.a.createElement(ae.a,null,l.a.createElement(se.a,null,s=>l.a.createElement(te,{branding:e.data,history:t,workspaces:a,onAction:(e,t)=>s.handleAction(e,t),showConfirmation:e=>s.showConfirmation(e),isDeleted:s.isDeleted})))}}const ne=Object(n.c)(e=>{const{branding:t}=e;return{branding:t,allWorkspaces:Object(r.a)(e),isLoading:Object(r.c)(e)}},i.a);t.default=ne(le)}}]);","extractedComments":[]}